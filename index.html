<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birbank | HR Audit</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --birbank: #E30613;
            --birbank-dark: #B8050F;
            --birbank-darker: #8B0000;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #1E293B;
            --text-muted: #64748B;
            --border: #E2E8F0;
            --success: #10B981;
            --success-bg: #ECFDF5;
            --warning: #F59E0B;
            --warning-bg: #FEF3C7;
            --info: #3B82F6;
            --info-bg: #EFF6FF;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: var(--bg); 
            color: var(--text);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--card);
            padding: 16px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.25rem;
            font-weight: 800;
        }

        .brand-icon { color: var(--birbank); font-size: 1.5rem; }
        .brand span { color: var(--text); }
        .brand .highlight { color: var(--birbank); }

        .sync-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--success-bg);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--success);
        }

        .sync-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        /* Hero */
        .hero {
            background: linear-gradient(135deg, var(--birbank) 0%, var(--birbank-dark) 60%, var(--birbank-darker) 100%);
            padding: 48px 40px;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 400px;
            height: 400px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 2.75rem;
            font-weight: 900;
            color: white;
            margin-bottom: 12px;
            letter-spacing: -1px;
        }

        .hero p {
            color: rgba(255,255,255,0.85);
            font-size: 1.1rem;
            font-weight: 500;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
        }

        /* Stats */
        .stats-section {
            margin-top: -30px;
            position: relative;
            z-index: 10;
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        .stat-card {
            background: var(--card);
            border-radius: 16px;
            padding: 20px 24px;
            display: flex;
            align-items: center;
            gap: 16px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }

        .stat-icon.red { background: #FEE2E2; color: var(--birbank); }
        .stat-icon.green { background: var(--success-bg); color: var(--success); }
        .stat-icon.yellow { background: var(--warning-bg); color: var(--warning); }
        .stat-icon.blue { background: var(--info-bg); color: var(--info); }

        .stat-content h3 {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--birbank);
            line-height: 1;
        }

        .stat-content p {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-weight: 600;
            margin-top: 4px;
        }

        .stat-card.progress-card {
            flex-direction: column;
            align-items: stretch;
            gap: 12px;
        }

        .stat-card.progress-card .stat-header {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .progress-bar-bg {
            height: 8px;
            background: var(--bg);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--birbank), var(--warning));
            border-radius: 10px;
            transition: width 0.5s;
        }

        /* Filter */
        .filter-section {
            background: var(--card);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }

        .filter-row {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .search-box {
            flex: 1;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 14px 20px 14px 48px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 500;
            background: var(--bg);
            transition: all 0.3s;
            color: var(--text);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--birbank);
            background: white;
            box-shadow: 0 0 0 4px rgba(227, 6, 19, 0.1);
        }

        .search-input::placeholder { color: var(--text-muted); }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 18px;
        }

        .filter-buttons { display: flex; gap: 10px; }

        .filter-btn {
            padding: 14px 24px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            background: white;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .filter-btn:hover {
            border-color: var(--birbank);
            color: var(--birbank);
        }

        .filter-btn.active {
            background: var(--birbank);
            border-color: var(--birbank);
            color: white;
        }

        /* Categories */
        .categories-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding-bottom: 40px;
        }

        .category-card {
            background: var(--card);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }

        .category-header {
            background: linear-gradient(135deg, var(--birbank) 0%, var(--birbank-dark) 100%);
            padding: 22px 28px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .category-header:hover {
            background: linear-gradient(135deg, var(--birbank-dark) 0%, var(--birbank) 100%);
        }

        .category-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .category-icon {
            width: 52px;
            height: 52px;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
        }

        .category-text h3 {
            color: white;
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .category-badge {
            background: rgba(255,255,255,0.25);
            padding: 5px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            color: white;
        }

        .category-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .category-progress {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            padding: 10px 16px;
            border-radius: 12px;
        }

        .category-progress-bar {
            width: 120px;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .category-progress-fill {
            height: 100%;
            background: white;
            border-radius: 10px;
            transition: width 0.5s;
        }

        .category-progress-text {
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
            min-width: 45px;
            text-align: right;
        }

        .category-toggle {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            transition: transform 0.3s;
        }

        .category-toggle.active { transform: rotate(180deg); }

        .category-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s;
        }

        .category-body.active { max-height: 100000px; }

        /* Subcategory */
        .subcategory { border-bottom: 1px solid var(--border); }
        .subcategory:last-child { border-bottom: none; }

        .subcategory-header {
            padding: 18px 28px;
            background: #F8FAFC;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .subcategory-header:hover { background: #EEF2F7; }

        .subcategory-title {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .subcategory-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--birbank), var(--birbank-dark));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .subcategory-name {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text);
        }

        .subcategory-count {
            background: var(--birbank);
            color: white;
            padding: 5px 14px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .subcategory-body {
            padding: 0;
            background: white;
            display: none;
        }

        .subcategory-body.active {
            display: block;
            padding: 24px 28px;
        }

        /* Item */
        .item {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 14px;
            transition: all 0.3s;
            position: relative;
        }

        .item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: transparent;
            border-radius: 14px 0 0 14px;
            transition: background 0.3s;
        }

        .item:hover {
            border-color: var(--birbank);
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(227, 6, 19, 0.1);
        }

        .item:hover::before { background: var(--birbank); }

        .item.checked {
            background: linear-gradient(135deg, #ECFDF5, #D1FAE5);
            border-color: var(--success);
        }

        .item.checked::before { background: var(--success); }

        .item.has-notes { border-color: var(--warning); }
        .item.has-notes::before { background: var(--warning); }

        .item-main {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .item-checkbox {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 3px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            background: white;
            flex-shrink: 0;
            margin-top: 2px;
            position: relative;
            transition: all 0.3s;
        }

        .item-checkbox:hover { border-color: var(--birbank); transform: scale(1.1); }

        .item-checkbox:checked {
            background: var(--success);
            border-color: var(--success);
        }

        .item-checkbox:checked::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 14px;
            font-weight: 900;
        }

        .item-content { flex: 1; }

        .item-text {
            font-size: 0.95rem;
            font-weight: 500;
            line-height: 1.6;
            margin-bottom: 12px;
            color: var(--text);
            transition: all 0.3s;
        }

        .item-text.completed {
            text-decoration: line-through;
            color: var(--text-muted);
        }

        .item-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }

        .badge {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .badge-status { background: #ECFDF5; color: #065F46; }
        .badge-person { background: #EFF6FF; color: #1E40AF; }
        .badge-priority { background: #FEE2E2; color: #991B1B; }

        .notes-preview {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A);
            border-left: 4px solid var(--warning);
            padding: 14px 16px;
            border-radius: 10px;
            margin-bottom: 14px;
            display: none;
        }

        .notes-preview.visible { display: block; }

        .notes-preview-header {
            font-weight: 700;
            color: #92400E;
            margin-bottom: 6px;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .notes-preview-text {
            color: var(--text);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }

        .btn-note { background: linear-gradient(135deg, var(--warning), #D97706); color: white; }
        .btn-primary { background: linear-gradient(135deg, var(--birbank), var(--birbank-dark)); color: white; }
        .btn-secondary { background: #6B7280; color: white; }

        /* Export */
        .export-section {
            background: linear-gradient(135deg, var(--birbank), var(--birbank-dark));
            padding: 32px 40px;
            display: flex;
            justify-content: center;
            gap: 16px;
        }

        .btn-export {
            background: white;
            color: var(--birbank);
            padding: 14px 28px;
            font-size: 0.95rem;
        }

        .btn-export:hover { background: #F8FAFC; }

        .footer {
            background: #1E293B;
            padding: 20px;
            text-align: center;
            color: rgba(255,255,255,0.6);
            font-size: 0.85rem;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.85);
            z-index: 2000;
            backdrop-filter: blur(6px);
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-dialog {
            background: white;
            border-radius: 24px;
            max-width: 650px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--birbank), var(--birbank-dark));
            padding: 30px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: white;
            margin-bottom: 6px;
        }

        .modal-subtitle {
            color: rgba(255,255,255,0.85);
            font-size: 0.95rem;
        }

        .modal-body { padding: 30px; }

        .form-group { margin-bottom: 24px; }

        .form-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.85rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text);
        }

        .form-label-icon {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, var(--birbank), var(--birbank-dark));
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 0.95rem;
            background: var(--bg);
            transition: all 0.3s;
            color: var(--text);
            font-family: inherit;
        }

        .form-textarea { min-height: 120px; resize: vertical; }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--birbank);
            background: white;
            box-shadow: 0 0 0 4px rgba(227, 6, 19, 0.1);
        }

        .modal-footer {
            padding: 0 30px 30px;
            display: flex;
            gap: 14px;
        }

        .modal-footer .btn { flex: 1; justify-content: center; padding: 16px; }

        .notification {
            position: fixed;
            top: 24px;
            right: 24px;
            background: white;
            border-radius: 16px;
            padding: 20px 24px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            z-index: 3000;
            display: none;
            min-width: 340px;
            border-left: 5px solid var(--success);
        }

        .notification.active { display: flex; gap: 16px; align-items: center; }
        .notification.error { border-left-color: #EF4444; }

        .notification-icon {
            width: 44px;
            height: 44px;
            background: var(--success);
            color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .notification.error .notification-icon { background: #EF4444; }
        .notification-title { font-weight: 700; margin-bottom: 4px; }
        .notification-text { font-size: 0.85rem; color: var(--text-muted); }

        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.8);
            z-index: 2500;
            backdrop-filter: blur(6px);
        }

        .loading.active { display: flex; justify-content: center; align-items: center; }

        .loading-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid var(--bg);
            border-top: 5px solid var(--birbank);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .loading-text { font-weight: 700; font-size: 1.05rem; color: var(--text); }

        @media (max-width: 1100px) { 
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .category-progress { display: none; }
        }
        @media (max-width: 768px) {
            .container { padding: 0 20px; }
            .header { padding: 12px 20px; }
            .hero { padding: 32px 20px; }
            .hero h1 { font-size: 2rem; }
            .stats-grid { grid-template-columns: 1fr; }
            .filter-row { flex-direction: column; }
            .filter-buttons { width: 100%; flex-wrap: wrap; }
            .filter-btn { flex: 1; justify-content: center; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="brand">
            <span class="brand-icon">â˜‘ï¸</span>
            <span>Birbank | <span class="highlight">HR Audit</span></span>
        </div>
        <div class="sync-badge">
            <div class="sync-dot"></div>
            <span>Google Sheets Aktiv</span>
        </div>
    </header>

    <section class="hero">
        <div class="hero-content">
            <h1>HR AUDIT CHECKLIST</h1>
            <p></p>
        </div>
    </section>

    <div class="container">
        <section class="stats-section">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon red">ğŸ“‹</div>
                    <div class="stat-content">
                        <h3 id="statTotal">0</h3>
                        <p>CÉ™mi MaddÉ™</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">âœ“</div>
                    <div class="stat-content">
                        <h3 id="statChecked">0</h3>
                        <p>TamamlandÄ±</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon yellow">ğŸ“</div>
                    <div class="stat-content">
                        <h3 id="statNotes">0</h3>
                        <p>Qeydli</p>
                    </div>
                </div>
                <div class="stat-card progress-card">
                    <div class="stat-header">
                        <div class="stat-icon blue">ğŸ“ˆ</div>
                        <div class="stat-content">
                            <h3 id="statProgress">0%</h3>
                            <p>Progress</p>
                        </div>
                    </div>
                    <div class="progress-bar-bg">
                        <div class="progress-bar-fill" id="progressBar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </section>

        <section class="filter-section">
            <div class="filter-row">
                <div class="search-box">
                    <span class="search-icon">ğŸ”</span>
                    <input type="text" id="searchInput" class="search-input" placeholder="MaddÉ™lÉ™r arasÄ±nda axtarÄ±ÅŸ edin...">
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="setFilter('all', this)">â‰¡ HamÄ±sÄ±</button>
                    <button class="filter-btn" onclick="setFilter('checked', this)">âœ“ TamamlanmÄ±ÅŸ</button>
                    <button class="filter-btn" onclick="setFilter('notes', this)">ğŸ“„ Qeydli</button>
                </div>
            </div>
        </section>

        <div class="categories-container" id="categoriesContainer"></div>
    </div>

    <section class="export-section">
        <button class="btn btn-export" onclick="exportToExcel()">ğŸ“Š Excel Export</button>
        <button class="btn btn-export" onclick="window.print()">ğŸ“„ PDF Export</button>
        <button class="btn btn-export" onclick="window.print()">ğŸ–¨ï¸ Print</button>
    </section>

    <footer class="footer">Â© 2025 HR Audit Checklist - Birbank Edition</footer>

    <div class="modal" id="noteModal">
        <div class="modal-dialog">
            <div class="modal-header">
                <div class="modal-title">ğŸ“ Qeyd ÆlavÉ™ Et</div>
                <div class="modal-subtitle">Audit mÉ™lumatlarÄ±nÄ± daxil edin</div>
            </div>
            <form id="noteForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label"><div class="form-label-icon">ğŸš¦</div>Status</label>
                        <select class="form-select" id="itemStatus">
                            <option value="completed">âœ… TamamlandÄ±</option>
                            <option value="in-progress">ğŸ”„ Ä°crada</option>
                            <option value="pending">â³ GÃ¶zlÉ™yir</option>
                            <option value="issue">âš ï¸ Problem var</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><div class="form-label-icon">ğŸ’¬</div>QeydlÉ™r</label>
                        <textarea class="form-textarea" id="itemNotes" placeholder="Audit mÉ™lumatlarÄ±nÄ± daxil edin..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><div class="form-label-icon">ğŸ‘¤</div>MÉ™sul ÅÉ™xs</label>
                        <input type="text" class="form-input" id="responsiblePerson" placeholder="Ad Soyad">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><div class="form-label-icon">ğŸš©</div>Prioritet</label>
                        <select class="form-select" id="itemPriority">
                            <option value="low">ğŸŸ¢ AÅŸaÄŸÄ±</option>
                            <option value="medium">ğŸŸ¡ Orta</option>
                            <option value="high">ğŸŸ  YÃ¼ksÉ™k</option>
                            <option value="critical">ğŸ”´ Kritik</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><div class="form-label-icon">ğŸ“…</div>Son Tarix</label>
                        <input type="date" class="form-input" id="itemDueDate">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">ğŸ’¾ Yadda Saxla</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">âŒ LÉ™ÄŸv et</button>
                </div>
            </form>
        </div>
    </div>

    <div class="notification" id="notification">
        <div class="notification-icon">âœ“</div>
        <div class="notification-content">
            <div class="notification-title" id="notificationTitle">UÄŸurlu!</div>
            <div class="notification-text" id="notificationText">ÆmÉ™liyyat tamamlandÄ±</div>
        </div>
    </div>

    <div class="loading" id="loadingOverlay">
        <div class="loading-box">
            <div class="spinner"></div>
            <div class="loading-text">Google Sheets-É™ gÃ¶ndÉ™rilir...</div>
        </div>
    </div>

    <script>
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwBJqpIDqu0ACuDkcb1_ueMm4jfga9JVpCVvtsU8q9Ct-c17nQ7YxJWBbpggvhJ_hS6/exec';

const auditData = {
    "1. HR Governance & Policy": {
        icon: "ğŸ“‹",
        subcategories: {
            "1.1 SiyasÉ™t vÉ™ Prosedurlar": [
                "HR siyasÉ™t vÉ™ prosedurlarÄ±nÄ±n mÃ¶vcudluÄŸu vÉ™ aktuallaÅŸdÄ±rÄ±lmasÄ±",
                "Daxili É™mÉ™k qaydalarÄ± aktÄ±nÄ±n mÃ¶vcudluÄŸu vÉ™ qanunvericiliyÉ™ uyÄŸunluÄŸu",
                "HR prosedurlarÄ±nÄ±n sÉ™nÉ™dlÉ™ÅŸdirilmÉ™si (recruitment, onboarding, offboarding)",
                "Konfidensiallik vÉ™ mÉ™xfilik siyasÉ™tlÉ™rinin mÃ¶vcudluÄŸu",
                "Etik kodeksin mÃ¶vcudluÄŸu vÉ™ iÅŸÃ§ilÉ™rÉ™ Ã§atdÄ±rÄ±lmasÄ±",
                "ÅikayÉ™t mexanizminin mÃ¶vcudluÄŸu vÉ™ iÅŸlÉ™rliyi",
                "Anti-korrupsiya vÉ™ anti-rÃ¼ÅŸvÉ™txorluq siyasÉ™tlÉ™ri",
                "DavranÄ±ÅŸ qaydalarÄ± vÉ™ intizam prosedurlarÄ±"
            ],
            "1.2 Struktur vÉ™ RollÉ™r": [
                "TÉ™ÅŸkilati strukturun mÃ¶vcudluÄŸu vÉ™ aktuallaÅŸdÄ±rÄ±lmasÄ±",
                "VÉ™zifÉ™ tÉ™limatlarÄ±nÄ±n bÃ¼tÃ¼n vÉ™zifÉ™lÉ™r Ã¼zrÉ™ mÃ¶vcudluÄŸu",
                "VÉ™zifÉ™ tÉ™limatlarÄ±nÄ±n aktuallaÅŸdÄ±rÄ±lmasÄ± (son 2 il É™rzindÉ™)",
                "SÉ™lahiyyÉ™t vÉ™ mÉ™suliyyÉ™t matrisinin mÃ¶vcudluÄŸu",
                "HR departamentinin strukturu vÉ™ resurslarÄ±nÄ±n kifayÉ™tliyi",
                "Rol vÉ™ mÉ™suliyyÉ™tlÉ™rin aydÄ±n mÃ¼É™yyÉ™nlÉ™ÅŸdirilmÉ™si"
            ],
            "1.3 Compliance vÉ™ Risk Ä°darÉ™etmÉ™si": [
                "ÆmÉ™k MÉ™cÉ™llÉ™si tÉ™lÉ™blÉ™rinÉ™ uyÄŸunluq",
                "SSÄ°V (DOST) É™laqÉ™lÉ™rinin dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Vergi qanunvericiliyinÉ™ uyÄŸunluq",
                "MÉ™lumat mÃ¼hafizÉ™si vÉ™ GDPR tÉ™lÉ™blÉ™rinÉ™ uyÄŸunluq",
                "HR risk reyestrinin mÃ¶vcudluÄŸu",
                "Daxili nÉ™zarÉ™t mexanizmlÉ™rinin mÃ¶vcudluÄŸu",
                "Xarici audit tÃ¶vsiyyÉ™lÉ™rinin icrasÄ±nÄ±n monitorinqi"
            ]
        }
    },
    "2. Recruitment & Onboarding": {
        icon: "ğŸ‘¥",
        subcategories: {
            "2.1 Ä°ÅŸÉ™ QÉ™bul Prosesi": [
                "Ä°ÅŸÉ™ qÉ™bul prosedurlarÄ±nÄ±n sÉ™nÉ™dlÉ™ÅŸdirilmÉ™si",
                "Vakansiya tÉ™sdiqlÉ™mÉ™ prosesinin mÃ¶vcudluÄŸu",
                "Ä°ÅŸ elanlarÄ±nÄ±n qanunvericiliyÉ™ uyÄŸunluÄŸu (diskriminasiyasÄ±z)",
                "NamizÉ™dlÉ™rin seÃ§im meyarlarÄ±nÄ±n mÃ¶vcudluÄŸu",
                "MÃ¼sahibÉ™ prosesinin strukturlaÅŸdÄ±rÄ±lmasÄ±",
                "Reference check prosesinin hÉ™yata keÃ§irilmÉ™si",
                "Background check prosedurlarÄ±nÄ±n mÃ¶vcudluÄŸu",
                "Job offer mÉ™ktublarÄ±nÄ±n standartlaÅŸdÄ±rÄ±lmasÄ±",
                "Ä°ÅŸÉ™ qÉ™bul qÉ™rarlarÄ±nÄ±n sÉ™nÉ™dlÉ™ÅŸdirilmÉ™si"
            ],
            "2.2 ÅÉ™xsi Ä°ÅŸlÉ™r vÉ™ SÉ™nÉ™dlÉ™ÅŸmÉ™": [
                "ÅÉ™xsi iÅŸlÉ™rin tam komplektliyi (hÉ™r bir vÉ™zifÉ™ Ã¼zrÉ™)",
                "ÆrizÉ™ vÉ™ CV-nin mÃ¶vcudluÄŸu",
                "ÅÉ™xsiyyÉ™t vÉ™siqÉ™sinin surÉ™tinin mÃ¶vcudluÄŸu",
                "TÉ™hsil haqqÄ±nda sÉ™nÉ™dlÉ™rin surÉ™tlÉ™rinin mÃ¶vcudluÄŸu",
                "Ä°xtisas sertifikatlarÄ±nÄ±n mÃ¶vcudluÄŸu (tÉ™lÉ™b olunarsa)",
                "Tibbi arayÄ±ÅŸÄ±n mÃ¶vcudluÄŸu vÉ™ mÃ¼ddÉ™tinin yoxlanÄ±lmasÄ±",
                "ÆvvÉ™lki iÅŸ yerlÉ™rindÉ™n É™mÉ™k kitabÃ§asÄ±nÄ±n surÉ™ti",
                "Foto ÅŸÉ™killÉ™rin mÃ¶vcudluÄŸu (2 É™dÉ™d 3x4)",
                "HÉ™rbi qulluqla baÄŸlÄ± sÉ™nÉ™dlÉ™rin mÃ¶vcudluÄŸu (kiÅŸilÉ™r Ã¼Ã§Ã¼n)",
                "AilÉ™ vÉ™ziyyÉ™ti haqqÄ±nda sÉ™nÉ™dlÉ™rin mÃ¶vcudluÄŸu",
                "Bank rekvizitlÉ™rinin mÃ¶vcudluÄŸu",
                "Konfidensiallik mÃ¼qavilÉ™sinin imzalanmasÄ±",
                "ÆMAS-a (SÄ°MA) qeydiyyatÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼"
            ],
            "2.3 ÆmÉ™k MÃ¼qavilÉ™lÉ™ri": [
                "ÆmÉ™k mÃ¼qavilÉ™lÉ™rinin yazÄ±lÄ± formasÄ±nÄ±n mÃ¶vcudluÄŸu",
                "MÃ¼qavilÉ™lÉ™rin qanunvericiliyÉ™ uyÄŸunluÄŸu",
                "SÄ±naq mÃ¼ddÉ™tinin dÃ¼zgÃ¼n tÉ™tbiqi vÉ™ sÉ™nÉ™dlÉ™ÅŸdirilmÉ™si",
                "Ä°ÅŸ vÉ™zifÉ™sinin dÉ™qiq gÃ¶stÉ™rilmÉ™si",
                "ÆmÉ™k haqqÄ± mÉ™blÉ™ÄŸinin dÃ¼zgÃ¼n É™ks olunmasÄ±",
                "Ä°ÅŸ saatlarÄ±nÄ±n vÉ™ iÅŸ rejiminin gÃ¶stÉ™rilmÉ™si",
                "Ä°ÅŸ yerinin gÃ¶stÉ™rilmÉ™si",
                "MÃ¼qavilÉ™ mÃ¼ddÉ™tinin gÃ¶stÉ™rilmÉ™si (mÃ¼ddÉ™tli/mÃ¼ddÉ™tsiz)",
                "TÉ™rÉ™flÉ™rin imzalarÄ±nÄ±n mÃ¶vcudluÄŸu vÉ™ tarixlÉ™ri",
                "Ä°ÅŸÃ§iyÉ™ nÃ¼sxÉ™nin tÉ™hvil verilmÉ™si"
            ],
            "2.4 Onboarding Prosesi": [
                "Onboarding proqramÄ±nÄ±n mÃ¶vcudluÄŸu",
                "Yeni iÅŸÃ§ilÉ™r Ã¼Ã§Ã¼n orientasiya tÉ™limlÉ™ri",
                "Ä°ÅŸ yerinin hazÄ±rlanmasÄ± (texnika, giriÅŸ kartlarÄ± vÉ™ s.)",
                "Mentor/buddy tÉ™yin edilmÉ™si",
                "Ä°lk gÃ¼nlÉ™r Ã¼Ã§Ã¼n checklist-in mÃ¶vcudluÄŸu",
                "SÄ±naq mÃ¼ddÉ™ti qiymÉ™tlÉ™ndirmÉ™ prosesinin hÉ™yata keÃ§irilmÉ™si"
            ]
        }
    },
    "3. ÆmÉ™k MÃ¼nasibÉ™tlÉ™ri": {
        icon: "ğŸ¤",
        subcategories: {
            "3.1 ÆmÉ™k MÃ¼qavilÉ™lÉ™rindÉ™ DÉ™yiÅŸikliklÉ™r": [
                "VÉ™zifÉ™ dÉ™yiÅŸikliklÉ™rinin dÃ¼zgÃ¼n rÉ™smilÉ™ÅŸdirilmÉ™si",
                "ÆlavÉ™ razÄ±laÅŸmalarÄ±n qanunvericiliyÉ™ uyÄŸunluÄŸu",
                "ÆmÉ™k haqqÄ± dÉ™yiÅŸikliklÉ™rinin sÉ™nÉ™dlÉ™ÅŸdirilmÉ™si",
                "Ä°ÅŸ yeri dÉ™yiÅŸikliklÉ™rinin dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Ä°ÅŸ rejimi dÉ™yiÅŸikliklÉ™rinin rÉ™smilÉ™ÅŸdirilmÉ™si",
                "KÃ¶Ã§Ã¼rmÉ™ É™mrlÉ™rinin qanunvericiliyÉ™ uyÄŸunluÄŸu",
                "ÆMAS-da dÉ™yiÅŸikliklÉ™rin É™ks olunmasÄ±"
            ],
            "3.2 Ä°ÅŸ VaxtÄ±nÄ±n UÃ§otu": [
                "Ä°ÅŸ vaxtÄ± uÃ§otunun aparÄ±lma formasÄ±",
                "Faktiki iÅŸ saatlarÄ±nÄ±n dÃ¼zgÃ¼n qeydiyyatÄ±",
                "Tabelin dÃ¼zgÃ¼n aparÄ±lmasÄ±",
                "Gec gÉ™lmÉ™lÉ™rin vÉ™ erkÉ™n Ã§Ä±xÄ±ÅŸlarÄ±n qeydiyyatÄ±",
                "Ä°ÅŸ vaxtÄ± sistemlÉ™rinin (HRIS) iÅŸlÉ™rliyi",
                "Ä°ÅŸ vaxtÄ± normalarÄ±na riayÉ™t edilmÉ™si",
                "GecÉ™ iÅŸ saatlarÄ±nÄ±n uÃ§otu",
                "Bayram vÉ™ istirahÉ™t gÃ¼nlÉ™rindÉ™ iÅŸin uÃ§otu"
            ],
            "3.3 NÃ¶vbÉ™li Ä°ÅŸ Qrafiki": [
                "NÃ¶vbÉ™ cÉ™dvÉ™llÉ™rinin qanunvericiliyÉ™ uyÄŸunluÄŸu",
                "CÉ™mlÉ™nmiÅŸ iÅŸ vaxtÄ± uÃ§otunun dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "NÃ¶vbÉ™lÉ™r arasÄ±nda fasilÉ™lÉ™rin tÉ™min edilmÉ™si (min. 42 saat)",
                "GecÉ™ nÃ¶vbÉ™lÉ™rinin qanunvericiliyÉ™ uyÄŸunluÄŸu",
                "Ã‡oxnÃ¶vbÉ™li iÅŸ qrafikinin dÃ¼zgÃ¼n tÉ™tbiqi",
                "Ä°ÅŸÃ§ilÉ™rin razÄ±lÄ±ÄŸÄ±nÄ±n alÄ±nmasÄ±",
                "NÃ¶vbÉ™ dÉ™yiÅŸikliklÉ™rinin qeydiyyatÄ±"
            ],
            "3.4 Ä°ntizam MÉ™suliyyÉ™ti": [
                "Ä°ntizam pozuntularÄ±nÄ±n qeydiyyatÄ±",
                "Ä°zahat mÉ™ktublarÄ±nÄ±n alÄ±nmasÄ±",
                "TÃ¶hmÉ™t É™mrlÉ™rinin qanunvericiliyÉ™ uyÄŸunluÄŸu",
                "ÅiddÉ™tli tÃ¶hmÉ™t tÉ™tbiqinin É™saslandÄ±rÄ±lmasÄ±",
                "Ä°ntizam cÉ™zalarÄ±nÄ±n proporsionallÄ±ÄŸÄ±",
                "CÉ™za tÉ™tbiq mÃ¼ddÉ™tlÉ™rinin riayÉ™t edilmÉ™si",
                "Ä°ÅŸÃ§inin mÃ¼dafiÉ™ hÃ¼ququnun tÉ™min edilmÉ™si",
                "Ä°ntizam iÅŸlÉ™rinin sÉ™nÉ™dlÉ™ÅŸdirilmÉ™si"
            ],
            "3.5 Xitam ProseslÉ™ri": [
                "Ä°ÅŸdÉ™n Ã§Ä±xarma É™saslarÄ±nÄ±n qanunilliyi",
                "XÉ™bÉ™rdarlÄ±q mÃ¼ddÉ™tlÉ™rinin dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Ä°xtisar edilmÉ™ proseduralarÄ±nÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Ã–dÉ™niÅŸlÉ™rin tam hesablanmasÄ±",
                "Ä°stifadÉ™ olunmamÄ±ÅŸ mÉ™zuniyyÉ™t kompensasiyasÄ±",
                "Ä°ÅŸ yerindÉ™n Ã§Ä±xarma kartÄ±nÄ±n dÃ¼zgÃ¼n tÉ™rtib olunmasÄ±",
                "ÆMAS-dan Ã§Ä±xarÄ±ÅŸÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "ÆmÉ™k kitabÃ§asÄ±na yazÄ±lÄ±ÅŸlarÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Exit interview prosesinin aparÄ±lmasÄ±",
                "Offboarding checklist-inin tamamlanmasÄ±"
            ]
        }
    },
    "4. MÉ™zuniyyÉ™tlÉ™r vÉ™ ÆlavÉ™ TÉ™tillÉ™r": {
        icon: "ğŸ–ï¸",
        subcategories: {
            "4.1 Ä°llik ÆmÉ™k MÉ™zuniyyÉ™tlÉ™ri": [
                "MÉ™zuniyyÉ™t planÄ±nÄ±n tÉ™rtib olunmasÄ±",
                "MÉ™zuniyyÉ™t hÃ¼ququnun dÃ¼zgÃ¼n hesablanmasÄ±",
                "MÉ™zuniyyÉ™t É™rizÉ™lÉ™rinin rÉ™smilÉ™ÅŸdirilmÉ™si",
                "MÉ™zuniyyÉ™t É™mrlÉ™rinin dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "MÉ™zuniyyÉ™t Ã¶dÉ™niÅŸlÉ™rinin hesablanmasÄ±",
                "MÉ™zuniyyÉ™t Ã¶dÉ™niÅŸinin 3 gÃ¼n É™vvÉ™l Ã¶dÉ™nilmÉ™si",
                "ÆmÉ™k mÉ™zuniyyÉ™tinin minimum 14 tÉ™qvim gÃ¼nÃ¼ olmasÄ±",
                "Ä°stifadÉ™ olunmamÄ±ÅŸ mÉ™zuniyyÉ™tlÉ™rin uÃ§otu",
                "MÉ™zuniyyÉ™t kompensasiyalarÄ±nÄ±n dÃ¼zgÃ¼n hesablanmasÄ±"
            ],
            "4.2 ÆlavÉ™ MÉ™zuniyyÉ™tlÉ™r": [
                "TÉ™hsil mÉ™zuniyyÉ™tlÉ™rinin qanunvericiliyÉ™ uyÄŸun verilmÉ™si",
                "HamilÉ™lik vÉ™ doÄŸum mÉ™zuniyyÉ™tlÉ™rinin dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "UÅŸaq baxÄ±mÄ± mÉ™zuniyyÉ™tlÉ™rinin rÉ™smilÉ™ÅŸdirilmÉ™si",
                "Ã–dÉ™niÅŸsiz mÉ™zuniyyÉ™tlÉ™rin dÃ¼zgÃ¼n tÉ™rtib olunmasÄ±",
                "QismÉ™n Ã¶dÉ™niÅŸli sosial mÉ™zuniyyÉ™tlÉ™rin qanunilliyi",
                "ÆlavÉ™ sosial mÉ™zuniyyÉ™tlÉ™rin (ailÉ™ hadisÉ™lÉ™ri) verilmÉ™si"
            ],
            "4.3 XÉ™stÉ™lik VÉ™rÉ™qÉ™lÉ™ri": [
                "XÉ™stÉ™lik vÉ™rÉ™qÉ™lÉ™rinin qanuni olaraq tÉ™rtib edilmÉ™si",
                "VÉ™rÉ™qÉ™lÉ™rin elektron sistemdÉ™ yoxlanÄ±lmasÄ±",
                "XÉ™stÉ™lik vÉ™rÉ™qÉ™lÉ™rinin uÃ§otu",
                "XÉ™stÉ™lik mÃ¼avinÉ™tinin hesablanmasÄ±",
                "SSÄ°V-dÉ™n kompensasiyanÄ±n alÄ±nmasÄ±",
                "XÉ™stÉ™lik vÉ™rÉ™qÉ™lÉ™ri Ã¼zrÉ™ É™mÉ™k haqqÄ± Ã¶dÉ™niÅŸlÉ™rinin dÃ¼zgÃ¼nlÃ¼yÃ¼"
            ]
        }
    },
    "5. Payroll vÉ™ Kompensasiya": {
        icon: "ğŸ’°",
        subcategories: {
            "5.1 ÆmÉ™k HaqqÄ± SistemlÉ™ri": [
                "ÆmÉ™k haqqÄ± siyasÉ™tinin mÃ¶vcudluÄŸu",
                "MaaÅŸ strukturunun ÅŸÉ™ffaflÄ±ÄŸÄ±",
                "ÆmÉ™k haqqÄ± dÉ™rÉ™cÉ™lÉ™rinin (grade/band) mÃ¶vcudluÄŸu",
                "Minimum É™mÉ™k haqqÄ± tÉ™lÉ™blÉ™rinÉ™ riayÉ™t",
                "ÆmÉ™k haqqÄ± artÄ±mÄ± prosedurlarÄ±nÄ±n mÃ¶vcudluÄŸu",
                "Bonus vÉ™ tÉ™ÅŸviq sistemlÉ™rinin sÉ™nÉ™dlÉ™ÅŸdirilmÉ™si",
                "ÆlavÉ™ Ã¶dÉ™niÅŸlÉ™rin (overtaym, gecÉ™, bayram) dÃ¼zgÃ¼n hesablanmasÄ±"
            ],
            "5.2 ÆmÉ™k HaqqÄ± HesablamalarÄ±": [
                "Faktiki iÅŸ saatlarÄ±na uyÄŸun hesablamalarÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "AylÄ±q É™mÉ™k haqqÄ± hesablamalarÄ±nÄ±n dÉ™qiqliyi",
                "ÆlavÉ™ iÅŸ saatlarÄ± Ã¼zrÉ™ É™mÉ™k haqqÄ±nÄ±n dÃ¼zgÃ¼n hesablanmasÄ±",
                "GecÉ™ saatlarÄ±nda iÅŸÉ™ gÃ¶rÉ™ É™lavÉ™ Ã¶dÉ™niÅŸ (50%)",
                "Bayram vÉ™ istirahÉ™t gÃ¼nlÉ™rindÉ™ iÅŸÉ™ gÃ¶rÉ™ É™lavÉ™ Ã¶dÉ™niÅŸ (100%)",
                "NÃ¶vbÉ™li iÅŸ qrafikindÉ™ É™mÉ™k haqqÄ± hesablamalarÄ±nÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "CÉ™mlÉ™nmiÅŸ uÃ§ot sistemindÉ™ hesablamalarÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "MÉ™zuniyyÉ™t Ã¶dÉ™niÅŸlÉ™rinin dÃ¼zgÃ¼n hesablanmasÄ±",
                "Orta É™mÉ™k haqqÄ±nÄ±n dÃ¼zgÃ¼n hesablanmasÄ±",
                "XÉ™stÉ™lik mÃ¼avinÉ™tinin dÃ¼zgÃ¼n hesablanmasÄ±",
                "EzamiyyÉ™ Ã¶dÉ™niÅŸlÉ™rinin hesablanmasÄ±"
            ],
            "5.3 Tutulmalar vÉ™ VergilÉ™r": [
                "GÉ™lir vergisinin (14%) dÃ¼zgÃ¼n tutulmasÄ±",
                "SSÄ°V-yÉ™ (3%) ayÄ±rmalarÄ±nÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Ä°ÅŸsizlikdÉ™n sÄ±ÄŸorta (0.5%) ayÄ±rmalarÄ±nÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Ä°ÅŸÉ™gÃ¶tÃ¼rÉ™n SSÄ°V tÃ¶hfÉ™lÉ™rinin (22%) dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Ä°cra vÉ™rÉ™qÉ™lÉ™ri Ã¼zrÉ™ tutulmalarÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "AlimentlÉ™rin dÃ¼zgÃ¼n tutulmasÄ±",
                "ÆmÉ™k haqqÄ± avanslarÄ±nÄ±n tutulmasÄ±",
                "DigÉ™r tutulmalarÄ±n qanuniliyi"
            ],
            "5.4 Payroll ProseslÉ™ri": [
                "Payroll calendar-Ä±n mÃ¶vcudluÄŸu",
                "ÆmÉ™k haqqÄ± Ã¶dÉ™niÅŸ tarixlÉ™rinin sabitliyi",
                "ÆmÉ™k haqqÄ± payslip-lÉ™rinin iÅŸÃ§ilÉ™rÉ™ verilmÉ™si",
                "Bank kÃ¶Ã§Ã¼rmÉ™lÉ™rinin vaxtÄ±nda hÉ™yata keÃ§irilmÉ™si",
                "Payroll mÉ™lumatlarÄ±nÄ±n arxivlÉ™ÅŸdirilmÉ™si",
                "Payroll mÉ™lumatlarÄ±nÄ±n mÉ™xfiliyinin tÉ™min edilmÉ™si",
                "ÆmÉ™k haqqÄ± Ã¼zrÉ™ hesabatlarÄ±n hazÄ±rlanmasÄ±"
            ],
            "5.5 EzamiyyÉ™tlÉ™r": [
                "EzamiyyÉ™ É™mrlÉ™rinin dÃ¼zgÃ¼n tÉ™rtib olunmasÄ±",
                "EzamiyyÉ™ vÉ™siqÉ™lÉ™rinin rÉ™smilÉ™ÅŸdirilmÉ™si",
                "GÃ¼ndÉ™lik Ã¶dÉ™niÅŸlÉ™rin qanunvericiliyÉ™ uyÄŸunluÄŸu",
                "Yol xÉ™rclÉ™rinin kompensasiyasÄ±",
                "YaÅŸayÄ±ÅŸ xÉ™rclÉ™rinin kompensasiyasÄ±",
                "EzamiyyÉ™ hesabatlarÄ±nÄ±n tÉ™qdim edilmÉ™si",
                "Xarici ezamiyyÉ™tlÉ™r Ã¼zrÉ™ xÃ¼susi qaydalarÄ±n tÉ™tbiqi"
            ]
        }
    },
    "6. Benefits vÉ™ Rewards": {
        icon: "ğŸ",
        subcategories: {
            "6.1 Sosial Paket": [
                "Sosial paket siyasÉ™tinin mÃ¶vcudluÄŸu",
                "Tibbi sÄ±ÄŸorta proqramÄ±nÄ±n mÃ¶vcudluÄŸu",
                "HÉ™yat sÄ±ÄŸortasÄ± proqramÄ±nÄ±n mÃ¶vcudluÄŸu",
                "Pensiya proqramÄ±nÄ±n mÃ¶vcudluÄŸu (kÃ¶nÃ¼llÃ¼)",
                "Nahar vÉ™ nÉ™qliyyat kompensasiyalarÄ±",
                "TÉ™hsil vÉ™ inkiÅŸaf proqramlarÄ±na dÉ™stÉ™k",
                "Ä°dman vÉ™ wellness proqramlarÄ±",
                "DigÉ™r benefits-lÉ™rin sÉ™nÉ™dlÉ™ÅŸdirilmÉ™si"
            ],
            "6.2 Performans Ä°darÉ™etmÉ™si": [
                "Performans qiymÉ™tlÉ™ndirmÉ™ sisteminin mÃ¶vcudluÄŸu",
                "KPI vÉ™ mÉ™qsÉ™dlÉ™rin mÃ¼É™yyÉ™nlÉ™ÅŸdirilmÉ™si",
                "MÃ¼tÉ™madi qiymÉ™tlÉ™ndirmÉ™ proseslÉ™rinin hÉ™yata keÃ§irilmÉ™si",
                "360 dÉ™rÉ™cÉ™ qiymÉ™tlÉ™ndirmÉ™ proseslÉ™ri",
                "Performans improvement planlarÄ±nÄ±n mÃ¶vcudluÄŸu",
                "Performans vÉ™ mÃ¼kafat É™laqÉ™sinin mÃ¶vcudluÄŸu"
            ],
            "6.3 Bonus vÉ™ Ä°nsentiv ProqramlarÄ±": [
                "Bonus siyasÉ™tinin mÃ¶vcudluÄŸu vÉ™ aydÄ±nlÄ±ÄŸÄ±",
                "Ä°llik bonus proqramlarÄ±nÄ±n mÃ¶vcudluÄŸu",
                "LayihÉ™ bonuslarÄ±nÄ±n ÅŸÉ™rtlÉ™ri",
                "TÉ™ÅŸviq proqramlarÄ±nÄ±n mÃ¶vcudluÄŸu",
                "Recognition proqramlarÄ±nÄ±n hÉ™yata keÃ§irilmÉ™si",
                "TÉ™qaÃ¼d vÉ™ mÃ¼kafat sistemlÉ™rinin mÃ¶vcudluÄŸu"
            ]
        }
    },
    "7. TÉ™lim vÉ™ Ä°nkiÅŸaf (L&D)": {
        icon: "ğŸ“š",
        subcategories: {
            "7.1 TÉ™lim ProqramlarÄ±": [
                "Ä°llik tÉ™lim planÄ±nÄ±n mÃ¶vcudluÄŸu",
                "TÉ™lim ehtiyaclarÄ±nÄ±n analizi (TNA)",
                "Onboarding tÉ™limlÉ™rinin keÃ§irilmÉ™si",
                "Texniki tÉ™limlÉ™rin tÉ™ÅŸkili",
                "Soft skills tÉ™limlÉ™rinin tÉ™ÅŸkili",
                "Liderlik inkiÅŸaf proqramlarÄ±",
                "Compliance tÉ™limlÉ™rinin keÃ§irilmÉ™si",
                "TÉ™limlÉ™rin effektivliyinin qiymÉ™tlÉ™ndirilmÉ™si",
                "TÉ™lim bÃ¼dcÉ™sinin idarÉ™ edilmÉ™si"
            ],
            "7.2 Karyera Ä°nkiÅŸafÄ±": [
                "Karyera inkiÅŸaf planlarÄ±nÄ±n mÃ¶vcudluÄŸu",
                "Succession planning proseslÉ™rinin mÃ¶vcudluÄŸu",
                "Mentorluq proqramlarÄ±nÄ±n hÉ™yata keÃ§irilmÉ™si",
                "Daxili mobilliyÉ™ dÉ™stÉ™k",
                "Talent management proqramlarÄ±",
                "Ä°nkiÅŸaf mÉ™rkÉ™zlÉ™rinin fÉ™aliyyÉ™ti"
            ]
        }
    },
    "8. HR SistemlÉ™ri (HRIS)": {
        icon: "ğŸ’»",
        subcategories: {
            "8.1 HRIS FunksionallÄ±q": [
                "HRIS sisteminin mÃ¶vcudluÄŸu vÉ™ funksionallÄ±ÄŸÄ±",
                "Ä°ÅŸÃ§i mÉ™lumatlarÄ±nÄ±n tam vÉ™ dÉ™qiq olmasÄ±",
                "Sistem vÉ™ faktiki mÉ™lumatlarÄ±n uyÄŸunluÄŸu",
                "Ä°ÅŸ vaxtÄ± uÃ§otu modulunun iÅŸlÉ™rliyi",
                "Payroll modulunun iÅŸlÉ™rliyi",
                "MÉ™zuniyyÉ™t idarÉ™etmÉ™ modulunun iÅŸlÉ™rliyi",
                "Performans idarÉ™etmÉ™ modulunun mÃ¶vcudluÄŸu",
                "Recruitment modulunun iÅŸlÉ™rliyi",
                "TÉ™lim idarÉ™etmÉ™ sisteminin mÃ¶vcudluÄŸu"
            ],
            "8.2 MÉ™lumat Ä°ntegriteti": [
                "MÉ™lumatlarÄ±n dÉ™qiqliyi vÉ™ aktuallaÅŸdÄ±rÄ±lmasÄ±",
                "TÉ™krarlanan mÉ™lumatlarÄ±n yoxlanÄ±lmasÄ±",
                "Sistem backup proseslÉ™rinin mÃ¶vcudluÄŸu",
                "MÉ™lumat miqrasiyasÄ± proseslÉ™rinin dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Sistem auditlÉ™rinin aparÄ±lmasÄ±",
                "Data cleaning proseslÉ™rinin hÉ™yata keÃ§irilmÉ™si"
            ],
            "8.3 Sistem TÉ™hlÃ¼kÉ™sizliyi": [
                "Ä°stifadÉ™Ã§i giriÅŸ hÃ¼quqlarÄ±nÄ±n idarÉ™ edilmÉ™si",
                "Parol siyasÉ™tlÉ™rinin mÃ¶vcudluÄŸu",
                "MÉ™lumat mÉ™xfiliyi tÉ™hlÃ¼kÉ™sizlik tÉ™dbirlÉ™rinin tÉ™tbiqi",
                "Sistem loglarÄ±nÄ±n saxlanÄ±lmasÄ±",
                "KibertÉ™hlÃ¼kÉ™sizlik tÉ™dbirlÉ™rinin tÉ™tbiqi",
                "GDPR vÉ™ mÉ™lumat mÃ¼hafizÉ™si tÉ™lÉ™blÉ™rinÉ™ uyÄŸunluq"
            ],
            "8.4 Sistem Ä°nteqrasiyasÄ±": [
                "ÆMAS (SÄ°MA) ilÉ™ inteqrasiyanÄ±n iÅŸlÉ™rliyi",
                "UÃ§ot sistemlÉ™ri ilÉ™ inteqrasiya",
                "Bank sistemlÉ™ri ilÉ™ É™laqÉ™lÉ™ndirmÉ™",
                "SSÄ°V (DOST) sistemi ilÉ™ inteqrasiya",
                "E-imza sistemlÉ™rinin istifadÉ™si",
                "DigÉ™r sistemlÉ™rlÉ™ API É™laqÉ™lÉ™ri"
            ]
        }
    },
    "9. HR Analytics vÉ™ Hesabatlar": {
        icon: "ğŸ“Š",
        subcategories: {
            "9.1 HR MetriklÉ™ri": [
                "Headcount hesabatlarÄ±nÄ±n dÉ™qiqliyi",
                "Turnover rate hesablamalarÄ±nÄ±n dÃ¼zgÃ¼nlÃ¼yÃ¼",
                "Absenteeism metriklÉ™ri",
                "Time to hire vÉ™ time to fill metriklÉ™ri",
                "Cost per hire hesablamalarÄ±",
                "Training ROI hesablamalarÄ±",
                "Employee engagement metriklÉ™ri",
                "Diversity metrics"
            ],
            "9.2 MÃ¼tÉ™madi Hesabatlar": [
                "AylÄ±q HR hesabatlarÄ±nÄ±n hazÄ±rlanmasÄ±",
                "RÃ¼blÃ¼k analitik hesabatlar",
                "Ä°llik HR hesabatlar",
                "SSÄ°V hesabatlarÄ±nÄ±n dÃ¼zgÃ¼n tÉ™rtib olunmasÄ±",
                "Vergi hesabatlarÄ±nÄ±n vaxtÄ±nda tÉ™qdim edilmÉ™si",
                "Ä°statistik hesabatlarÄ±n hazÄ±rlanmasÄ±",
                "DÃ¶vlÉ™t orqanlarÄ±na hesabatlarÄ±n vaxtÄ±nda tÉ™qdim edilmÉ™si"
            ]
        }
    },
    "10. Ä°ÅŸ MÃ¼hafizÉ™si vÉ™ TÉ™hlÃ¼kÉ™sizlik": {
        icon: "ğŸ›¡ï¸",
        subcategories: {
            "10.1 Ä°ÅŸ MÃ¼hafizÉ™si": [
                "Ä°ÅŸ mÃ¼hafizÉ™si Ã¼zrÉ™ siyasÉ™tlÉ™rin mÃ¶vcudluÄŸu",
                "Ä°ÅŸ mÃ¼hafizÉ™si Ã¼zrÉ™ cavabdeh ÅŸÉ™xslÉ™rin tÉ™yin edilmÉ™si",
                "Ä°ÅŸ yerlÉ™rinin attestasiyasÄ±nÄ±n keÃ§irilmÉ™si",
                "Risk qiymÉ™tlÉ™ndirmÉ™nin aparÄ±lmasÄ±",
                "Ä°lkin vÉ™ periodik tibbi mÃ¼ayinÉ™lÉ™rin keÃ§irilmÉ™si",
                "Ä°ÅŸ mÃ¼hafizÉ™si tÉ™limlÉ™rinin keÃ§irilmÉ™si",
                "FÉ™rdi mÃ¼hafizÉ™ vasitÉ™lÉ™rinin tÉ™min edilmÉ™si",
                "Ä°ÅŸ qÉ™zalarÄ±nÄ±n qeydiyyatÄ± vÉ™ araÅŸdÄ±rÄ±lmasÄ±",
                "PeÅŸÉ™ xÉ™stÉ™liklÉ™rinin profilaktikasÄ±"
            ],
            "10.2 FÃ¶vqÉ™ladÉ™ Hallar": [
                "TÉ™xliyÉ™ planlarÄ±nÄ±n mÃ¶vcudluÄŸu",
                "YanÄŸÄ±n tÉ™hlÃ¼kÉ™sizliyi tÉ™limlÉ™rinin keÃ§irilmÉ™si",
                "Ä°lk yardÄ±m tÉ™limlÉ™rinin keÃ§irilmÉ™si",
                "FÃ¶vqÉ™ladÉ™ hallar Ã¼zrÉ™ É™laqÉ™ mÉ™lumatlarÄ±",
                "Krizis idarÉ™etmÉ™ planlarÄ±nÄ±n mÃ¶vcudluÄŸu"
            ]
        }
    },
    "11. Employee Engagement vÉ™ Culture": {
        icon: "ğŸ­",
        subcategories: {
            "11.1 Ä°ÅŸÃ§i MÉ™mnuniyyÉ™ti": [
                "Employee engagement sorÄŸularÄ±nÄ±n keÃ§irilmÉ™si",
                "Pulse survey-lÉ™rin mÃ¼tÉ™madi aparÄ±lmasÄ±",
                "Exit interview mÉ™lumatlarÄ±nÄ±n analizi",
                "Stay interview proseslÉ™rinin hÉ™yata keÃ§irilmÉ™si",
                "ÅikayÉ™t mexanizminin effektivliyi",
                "Employee Net Promoter Score (eNPS) Ã¶lÃ§Ã¼lmÉ™si"
            ],
            "11.2 TÉ™ÅŸkilati MÉ™dÉ™niyyÉ™t": [
                "Korporativ dÉ™yÉ™rlÉ™rin mÃ¼É™yyÉ™nlÉ™ÅŸdirilmÉ™si",
                "DÉ™yÉ™rlÉ™rin iÅŸÃ§ilÉ™rÉ™ Ã§atdÄ±rÄ±lmasÄ±",
                "Team building tÉ™dbirlÉ™rinin tÉ™ÅŸkili",
                "Korporativ tÉ™dbirlÉ™rin keÃ§irilmÉ™si",
                "Daxili kommunikasiya kanallarÄ±nÄ±n effektivliyi",
                "Recognition proqramlarÄ±nÄ±n fÉ™aliyyÉ™ti"
            ]
        }
    },
    "12. Diversity, Equity & Inclusion (DEI)": {
        icon: "ğŸŒˆ",
        subcategories: {
            "12.1 DEI SiyasÉ™tlÉ™ri": [
                "DEI siyasÉ™tinin mÃ¶vcudluÄŸu",
                "BÉ™rabÉ™r imkanlar siyasÉ™tinin tÉ™tbiqi",
                "Anti-diskriminasiya siyasÉ™tlÉ™rinin mÃ¶vcudluÄŸu",
                "Cinsi tÉ™cavÃ¼z vÉ™ harassment siyasÉ™tlÉ™ri",
                "ÆlillÉ™rin É™mÉ™k hÃ¼quqlarÄ±nÄ±n tÉ™min edilmÉ™si",
                "Gender pay gap analizinin aparÄ±lmasÄ±",
                "DEI metriklÉ™ri vÉ™ hesabatlar"
            ]
        }
    },
    "13. Vendor vÉ™ ÃœÃ§Ã¼ncÃ¼ TÉ™rÉ™f Ä°darÉ™etmÉ™si": {
        icon: "ğŸ¤",
        subcategories: {
            "13.1 Vendor Ä°darÉ™etmÉ™si": [
                "HR xidmÉ™ti provayderlÉ™ri ilÉ™ mÃ¼qavilÉ™lÉ™r",
                "Recruitment agentliklÉ™ri ilÉ™ É™mÉ™kdaÅŸlÄ±q",
                "TÉ™lim provayderlÉ™ri ilÉ™ mÃ¼qavilÉ™lÉ™r",
                "Payroll outsourcing mÃ¼qavilÉ™lÉ™ri (É™gÉ™r varsa)",
                "Background check provayderlÉ™ri",
                "Tibbi sÄ±ÄŸorta ÅŸirkÉ™tlÉ™ri ilÉ™ mÃ¼qavilÉ™lÉ™r",
                "HRIS vendor idarÉ™etmÉ™si",
                "SLA-larÄ±n yerinÉ™ yetirilmÉ™sinin monitorinqi"
            ]
        }
    },
    "14. SÉ™nÉ™d Ä°darÉ™etmÉ™si vÉ™ ArxivlÉ™ÅŸdirmÉ™": {
        icon: "ğŸ“",
        subcategories: {
            "14.1 SÉ™nÉ™d Ä°darÉ™etmÉ™si": [
                "SÉ™nÉ™d idarÉ™etmÉ™ siyasÉ™tinin mÃ¶vcudluÄŸu",
                "ÅÉ™xsi iÅŸlÉ™rin saxlanma qaydalarÄ±",
                "SÉ™nÉ™dlÉ™rin arxivlÉ™ÅŸdirilmÉ™si",
                "SÉ™nÉ™dlÉ™rin mÉ™hv edilmÉ™si qaydalarÄ±",
                "Elektron sÉ™nÉ™d dÃ¶vriyyÉ™sinin tÉ™ÅŸkili",
                "SÉ™nÉ™dlÉ™rÉ™ giriÅŸ hÃ¼quqlarÄ±nÄ±n idarÉ™ edilmÉ™si",
                "SÉ™nÉ™dlÉ™rin qorunmasÄ± vÉ™ tÉ™hlÃ¼kÉ™sizliyi",
                "SÉ™nÉ™d saxlama mÃ¼ddÉ™tlÉ™rinÉ™ riayÉ™t edilmÉ™si (75 il)"
            ]
        }
    },
    "15. Audit vÉ™ Compliance Monitorinqi": {
        icon: "âœ…",
        subcategories: {
            "15.1 Audit ProseslÉ™ri": [
                "Daxili auditlÉ™rin mÃ¼tÉ™madi aparÄ±lmasÄ±",
                "Xarici auditlÉ™rÉ™ hazÄ±rlÄ±q",
                "Compliance checklist-lÉ™rinin istifadÉ™si",
                "NÃ¶qsanlarÄ±n aradan qaldÄ±rÄ±lmasÄ± planlarÄ±",
                "ÆmÉ™k mÃ¼fÉ™ttiÅŸliyinin yoxlamalarÄ±na hazÄ±rlÄ±q",
                "SSÄ°V yoxlamalarÄ±na hazÄ±rlÄ±q",
                "Vergi orqanlarÄ± yoxlamalarÄ±na hazÄ±rlÄ±q",
                "Audit tÃ¶vsiyyÉ™lÉ™rinin icrasÄ±nÄ±n izlÉ™nmÉ™si"
            ]
        }
    }
};

let auditItems = {};
let currentItemId = null;
let currentFilter = 'all';
let categoryItemsMap = {};
let itemIdMap = {}; // Item index -> Unique ID mapping

// Unikal ID generatoru
function generateUniqueId(category, subcategory, itemIndex) {
    // Kateqoriya vÉ™ alt-kateqoriyanÄ±n qÄ±sa versiyasÄ±nÄ± yarat
    const catShort = category.replace(/[^a-zA-Z0-9]/g, '').substring(0, 10);
    const subShort = subcategory.replace(/[^a-zA-Z0-9]/g, '').substring(0, 10);
    return `HR-${catShort}-${subShort}-${itemIndex}`;
}

function init() {
    renderCategories();
    updateStats();
    setupEventListeners();
    loadAuditData();
}

function renderCategories() {
    const container = document.getElementById('categoriesContainer');
    container.innerHTML = '';
    let globalItemIndex = 0;
    
    for (const [category, data] of Object.entries(auditData)) {
        let totalItems = 0;
        let subcategoriesHtml = '';
        const categoryId = category.replace(/[^a-zA-Z0-9]/g, '_');
        categoryItemsMap[categoryId] = [];
        
        let subcatIndex = 0;
        for (const [subcategory, items] of Object.entries(data.subcategories)) {
            totalItems += items.length;
            let itemsHtml = '';
            
            items.forEach((item, localItemIndex) => {
                const itemId = `item-${globalItemIndex}`;
                const uniqueId = generateUniqueId(category, subcategory, localItemIndex);
                itemIdMap[itemId] = uniqueId;
                categoryItemsMap[categoryId].push(itemId);
                
                itemsHtml += `
                    <div class="item" id="${itemId}" data-category="${category}" data-subcategory="${subcategory}" data-item="${item}" data-unique-id="${uniqueId}">
                        <div class="item-main">
                            <input type="checkbox" class="item-checkbox" onchange="toggleItem('${itemId}', '${categoryId}')">
                            <div class="item-content">
                                <div class="item-text" id="text-${itemId}">${item}</div>
                                <div class="item-badges" id="badges-${itemId}"></div>
                                <div class="notes-preview" id="notes-preview-${itemId}">
                                    <div class="notes-preview-header">ğŸ“ QEYDLÆR:</div>
                                    <div class="notes-preview-text" id="notes-text-${itemId}"></div>
                                </div>
                                <button class="btn btn-note" onclick="openNoteModal('${itemId}')">ğŸ“ Qeyd ÆlavÉ™ Et</button>
                            </div>
                        </div>
                    </div>
                `;
                globalItemIndex++;
            });
            subcatIndex++;

            subcategoriesHtml += `
                <div class="subcategory">
                    <div class="subcategory-header" onclick="toggleSubcategory(this)">
                        <div class="subcategory-title">
                            <div class="subcategory-icon">ğŸ“‚</div>
                            <div class="subcategory-name">${subcategory}</div>
                        </div>
                        <div class="subcategory-count">${items.length}</div>
                    </div>
                    <div class="subcategory-body">${itemsHtml}</div>
                </div>
            `;
        }

        container.innerHTML += `
            <div class="category-card" data-category-id="${categoryId}">
                <div class="category-header" onclick="toggleCategory(this)">
                    <div class="category-info">
                        <div class="category-icon">${data.icon}</div>
                        <div class="category-text">
                            <h3>${category}</h3>
                            <span class="category-badge" id="badge-${categoryId}">0/${totalItems} maddÉ™</span>
                        </div>
                    </div>
                    <div class="category-right">
                        <div class="category-progress">
                            <div class="category-progress-bar">
                                <div class="category-progress-fill" id="progress-${categoryId}" style="width: 0%"></div>
                            </div>
                            <div class="category-progress-text" id="progress-text-${categoryId}">0%</div>
                        </div>
                        <div class="category-toggle">â–¼</div>
                    </div>
                </div>
                <div class="category-body">${subcategoriesHtml}</div>
            </div>
        `;
    }
}

function toggleCategory(header) {
    const body = header.nextElementSibling;
    const icon = header.querySelector('.category-toggle');
    body.classList.toggle('active');
    icon.classList.toggle('active');
}

function toggleSubcategory(header) {
    header.nextElementSibling.classList.toggle('active');
}

async function toggleItem(itemId, categoryId) {
    const item = document.getElementById(itemId);
    const checkbox = item.querySelector('.item-checkbox');
    const isChecked = checkbox.checked;
    const textEl = document.getElementById(`text-${itemId}`);
    const uniqueId = item.dataset.uniqueId;
    
    // Strikethrough effekti
    if (isChecked) {
        item.classList.add('checked');
        textEl.classList.add('completed');
    } else {
        item.classList.remove('checked');
        textEl.classList.remove('completed');
    }
    
    // Data-nÄ± yenilÉ™
    if (!auditItems[itemId]) {
        auditItems[itemId] = {
            id: uniqueId,
            category: item.dataset.category,
            subcategory: item.dataset.subcategory,
            item: item.dataset.item
        };
    }
    auditItems[itemId].checked = isChecked;
    auditItems[itemId].status = isChecked ? 'completed' : 'pending';
    auditItems[itemId].id = uniqueId;
    
    // Badges yenilÉ™
    updateBadges(itemId);
    
    saveAuditData();
    updateStats();
    updateCategoryProgress(categoryId);
    
    // Google Sheets-É™ gÃ¶ndÉ™r (ID ilÉ™)
    await sendToGoogleSheets({
        id: uniqueId,
        category: auditItems[itemId].category,
        subcategory: auditItems[itemId].subcategory,
        item: auditItems[itemId].item,
        status: auditItems[itemId].status,
        notes: auditItems[itemId].notes || '',
        responsible: auditItems[itemId].responsible || '',
        priority: auditItems[itemId].priority || '',
        dueDate: auditItems[itemId].dueDate || ''
    });
}

function updateCategoryProgress(categoryId) {
    const items = categoryItemsMap[categoryId] || [];
    let checked = 0;
    
    items.forEach(itemId => {
        const item = document.getElementById(itemId);
        if (item && item.querySelector('.item-checkbox').checked) {
            checked++;
        }
    });
    
    const total = items.length;
    const progress = total > 0 ? Math.round((checked / total) * 100) : 0;
    
    const progressBar = document.getElementById(`progress-${categoryId}`);
    const progressText = document.getElementById(`progress-text-${categoryId}`);
    const badge = document.getElementById(`badge-${categoryId}`);
    
    if (progressBar) progressBar.style.width = progress + '%';
    if (progressText) progressText.textContent = progress + '%';
    if (badge) badge.textContent = `${checked}/${total} maddÉ™`;
}

function updateAllCategoryProgress() {
    for (const categoryId of Object.keys(categoryItemsMap)) {
        updateCategoryProgress(categoryId);
    }
}

function setFilter(filter, btn) {
    currentFilter = filter;
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    applyFilters();
}

function openNoteModal(itemId) {
    currentItemId = itemId;
    document.getElementById('noteModal').classList.add('active');
    if (auditItems[itemId]) {
        document.getElementById('itemStatus').value = auditItems[itemId].status || 'pending';
        document.getElementById('itemNotes').value = auditItems[itemId].notes || '';
        document.getElementById('responsiblePerson').value = auditItems[itemId].responsible || '';
        document.getElementById('itemPriority').value = auditItems[itemId].priority || 'medium';
        document.getElementById('itemDueDate').value = auditItems[itemId].dueDate || '';
    } else {
        document.getElementById('noteForm').reset();
    }
}

function closeModal() {
    document.getElementById('noteModal').classList.remove('active');
    currentItemId = null;
}

function setupEventListeners() {
    document.getElementById('searchInput').addEventListener('input', applyFilters);
    document.getElementById('noteForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        await saveNote();
    });
    document.getElementById('noteModal').addEventListener('click', function(e) {
        if (e.target === this) closeModal();
    });
}

async function saveNote() {
    if (!currentItemId) return;
    const item = document.getElementById(currentItemId);
    const status = document.getElementById('itemStatus').value;
    const isCompleted = status === 'completed';
    const uniqueId = item.dataset.uniqueId;
    
    const checkbox = item.querySelector('.item-checkbox');
    const textEl = document.getElementById(`text-${currentItemId}`);
    
    checkbox.checked = isCompleted;
    if (isCompleted) {
        item.classList.add('checked');
        textEl.classList.add('completed');
    } else {
        item.classList.remove('checked');
        textEl.classList.remove('completed');
    }
    
    auditItems[currentItemId] = {
        id: uniqueId,
        category: item.dataset.category,
        subcategory: item.dataset.subcategory,
        item: item.dataset.item,
        status: status,
        notes: document.getElementById('itemNotes').value,
        responsible: document.getElementById('responsiblePerson').value,
        priority: document.getElementById('itemPriority').value,
        dueDate: document.getElementById('itemDueDate').value,
        checked: isCompleted
    };

    const notes = auditItems[currentItemId].notes;
    if (notes) {
        item.classList.add('has-notes');
        document.getElementById(`notes-preview-${currentItemId}`).classList.add('visible');
        document.getElementById(`notes-text-${currentItemId}`).textContent = notes.length > 120 ? notes.substring(0, 120) + '...' : notes;
    } else {
        item.classList.remove('has-notes');
        document.getElementById(`notes-preview-${currentItemId}`).classList.remove('visible');
    }

    updateBadges(currentItemId);
    saveAuditData();
    updateStats();
    updateAllCategoryProgress();
    
    // Google Sheets-É™ gÃ¶ndÉ™r (ID ilÉ™)
    await sendToGoogleSheets({
        id: uniqueId,
        category: auditItems[currentItemId].category,
        subcategory: auditItems[currentItemId].subcategory,
        item: auditItems[currentItemId].item,
        status: auditItems[currentItemId].status,
        notes: auditItems[currentItemId].notes || '',
        responsible: auditItems[currentItemId].responsible || '',
        priority: auditItems[currentItemId].priority || '',
        dueDate: auditItems[currentItemId].dueDate || ''
    });
    
    closeModal();
}

function updateBadges(itemId) {
    const data = auditItems[itemId];
    let html = '';
    if (data?.status) {
        const labels = {'completed':'âœ… TamamlandÄ±','in-progress':'ğŸ”„ Ä°crada','pending':'â³ GÃ¶zlÉ™yir','issue':'âš ï¸ Problem'};
        html += `<span class="badge badge-status">${labels[data.status]}</span>`;
    }
    if (data?.responsible) html += `<span class="badge badge-person">ğŸ‘¤ ${data.responsible}</span>`;
    if (data?.priority && data.priority !== 'medium') {
        const labels = {'low':'ğŸŸ¢ AÅŸaÄŸÄ±','high':'ğŸŸ  YÃ¼ksÉ™k','critical':'ğŸ”´ Kritik'};
        html += `<span class="badge badge-priority">${labels[data.priority]}</span>`;
    }
    document.getElementById(`badges-${itemId}`).innerHTML = html;
}

async function sendToGoogleSheets(data) {
    document.getElementById('loadingOverlay').classList.add('active');
    try {
        await fetch(GOOGLE_SCRIPT_URL, { 
            method: 'POST', 
            mode: 'no-cors', 
            headers: { 'Content-Type': 'application/json' }, 
            body: JSON.stringify(data) 
        });
        showNotification('UÄŸurlu!', 'MÉ™lumat Google Sheets-É™ gÃ¶ndÉ™rildi', 'success');
    } catch (error) {
        showNotification('XÉ™ta!', 'GÃ¶ndÉ™rilmÉ™ zamanÄ± xÉ™ta baÅŸ verdi', 'error');
    } finally {
        document.getElementById('loadingOverlay').classList.remove('active');
    }
}

function saveAuditData() {
    document.querySelectorAll('.item').forEach(item => {
        const itemId = item.id;
        const uniqueId = item.dataset.uniqueId;
        
        if (!auditItems[itemId]) {
            auditItems[itemId] = { 
                id: uniqueId,
                category: item.dataset.category, 
                subcategory: item.dataset.subcategory, 
                item: item.dataset.item, 
                checked: item.querySelector('.item-checkbox').checked,
                status: item.querySelector('.item-checkbox').checked ? 'completed' : 'pending'
            };
        } else {
            auditItems[itemId].id = uniqueId;
            auditItems[itemId].checked = item.querySelector('.item-checkbox').checked;
            if (item.querySelector('.item-checkbox').checked) {
                auditItems[itemId].status = 'completed';
            }
        }
    });
    localStorage.setItem('auditData', JSON.stringify(auditItems));
}

function loadAuditData() {
    const saved = localStorage.getItem('auditData');
    if (saved) {
        auditItems = JSON.parse(saved);
        for (const [itemId, data] of Object.entries(auditItems)) {
            const item = document.getElementById(itemId);
            if (item) {
                const checkbox = item.querySelector('.item-checkbox');
                const textEl = document.getElementById(`text-${itemId}`);
                
                // ID-ni yenilÉ™ (É™gÉ™r kÃ¶hnÉ™ data-da yoxdursa)
                if (!data.id) {
                    data.id = item.dataset.uniqueId;
                }
                
                checkbox.checked = data.checked;
                
                if (data.checked || data.status === 'completed') {
                    item.classList.add('checked');
                    textEl.classList.add('completed');
                }
                
                if (data.notes) {
                    item.classList.add('has-notes');
                    document.getElementById(`notes-preview-${itemId}`)?.classList.add('visible');
                    const previewText = document.getElementById(`notes-text-${itemId}`);
                    if (previewText) previewText.textContent = data.notes.length > 120 ? data.notes.substring(0, 120) + '...' : data.notes;
                }
                updateBadges(itemId);
            }
        }
        updateStats();
        updateAllCategoryProgress();
    }
}

function updateStats() {
    const items = document.querySelectorAll('.item');
    let checked = 0, withNotes = 0;
    items.forEach(item => {
        if (item.querySelector('.item-checkbox').checked) checked++;
        if (item.classList.contains('has-notes')) withNotes++;
    });
    const progress = items.length > 0 ? Math.round((checked / items.length) * 100) : 0;
    document.getElementById('statTotal').textContent = items.length;
    document.getElementById('statChecked').textContent = checked;
    document.getElementById('statNotes').textContent = withNotes;
    document.getElementById('statProgress').textContent = progress + '%';
    document.getElementById('progressBar').style.width = progress + '%';
}

function applyFilters() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    document.querySelectorAll('.item').forEach(item => {
        const text = item.querySelector('.item-text').textContent.toLowerCase();
        const isChecked = item.classList.contains('checked');
        const hasNotes = item.classList.contains('has-notes');
        let matchesSearch = text.includes(searchTerm);
        let matchesFilter = currentFilter === 'all' || (currentFilter === 'checked' && isChecked) || (currentFilter === 'notes' && hasNotes);
        item.style.display = (matchesSearch && matchesFilter) ? 'block' : 'none';
    });
}

function showNotification(title, text, type = 'success') {
    const notification = document.getElementById('notification');
    document.getElementById('notificationTitle').textContent = title;
    document.getElementById('notificationText').textContent = text;
    notification.className = 'notification active' + (type === 'error' ? ' error' : '');
    setTimeout(() => notification.classList.remove('active'), 4000);
}

function exportToExcel() {
    let csv = '\ufeffID,Kateqoriya,Alt Kateqoriya,MaddÉ™,Status,QeydlÉ™r,MÉ™sul ÅÉ™xs,Prioritet,Son Tarix\n';
    for (const [itemId, data] of Object.entries(auditItems)) {
        if (data.checked || data.notes) {
            csv += `"${data.id || ''}","${data.category}","${data.subcategory}","${data.item}","${data.status||''}","${data.notes||''}","${data.responsible||''}","${data.priority||''}","${data.dueDate||''}"\n`;
        }
    }
    const link = document.createElement('a');
    link.href = URL.createObjectURL(new Blob([csv], { type: 'text/csv;charset=utf-8;' }));
    link.download = `HR_Audit_${new Date().toISOString().split('T')[0]}.csv`;
    link.click();
    showNotification('UÄŸurlu!', 'Excel faylÄ± yÃ¼klÉ™ndi', 'success');
}

window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
